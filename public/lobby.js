(()=>{"use strict";var t=document.querySelector(".canvas"),e=t.getContext("2d");function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}e.save();var o=new WeakMap,i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),o.set(this,{writable:!0,value:this})}var e,i;return e=t,(i=[{key:"getNext",value:function(){return function(t,e){return e.get?e.get.call(t):e.value}(this,r(this,o,"get"))}},{key:"setNext",value:function(t){var e,n;n=t,function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(e=this,r(e,o,"set"),n)}},{key:"onComplete",value:function(){alert("complete")}},{key:"init",value:function(){}},{key:"update",value:function(t){}}])&&n(e.prototype,i),t}(),a=new WebSocket("ws://"+window.location.host+window.location.pathname),c=function(t){},u=function(t,e){},s=function(t){},l=function(t){};function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?m(t):e}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function b(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,x(t,e,"set"),n),n}function g(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function w(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,x(t,e,"get"))}function x(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}a.onopen=function(t){a.send("con")},a.onmessage=function(t){var e=t.data.split(" ");"start"==e[0]&&c(a),"player"==e[0]&&u(e[1],e[2]),"place"==e[0]&&s({x:Number(e[1]),y:Number(e[2])}),"turn"==e[0]&&l(e[1])};var k=!1;c=function(t){t.send("player ".concat(ce.local.color," ").concat(ce.local.nickname)),k=!0},function(t){u=t}((function(t,e){ce.remote.color=t,ce.remote.nickname=e}));var _=new WeakMap,T=new WeakMap,P=new WeakMap,E=new WeakMap,O=new WeakMap,S=new WeakMap,C=new WeakMap,M=new WeakMap,j=new WeakSet,A=function(n){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(u,n);var r,o,i,a,c=(i=u,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=v(i);if(a){var n=v(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return d(this,t)});function u(){var e;p(this,u);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=c.call.apply(c,[this].concat(r)),j.add(m(e)),_.set(m(e),{writable:!0,value:t.width}),T.set(m(e),{writable:!0,value:t.height}),P.set(m(e),{writable:!0,value:7}),E.set(m(e),{writable:!0,value:70}),O.set(m(e),{writable:!0,value:5}),S.set(m(e),{writable:!0,value:1}),C.set(m(e),{writable:!0,value:0}),M.set(m(e),{writable:!0,value:1}),e}return r=u,(o=[{key:"update",value:function(t){e.fillStyle=ce.local.color;for(var n=0;n<w(this,O);++n){e.beginPath();var r=g(this,j,z).call(this,w(this,C)+.1*n);e.arc(Math.sin(r)*w(this,E)+w(this,_)/2,Math.cos(r)*w(this,E)+w(this,T)/2,w(this,P),0,2*Math.PI),e.fill()}b(this,C,w(this,C)+w(this,S)*t),k&&(w(this,M)>0&&b(this,M,w(this,M)-w(this,S)*t),w(this,M)<0?e.globalAlpha=0:e.globalAlpha=w(this,M),w(this,M)<=0&&this.onComplete())}}])&&h(r.prototype,o),u}(i);function z(t){return 4*(Math.atan(t%2-1)+4*Math.PI)}function I(t,e){"number"!=typeof t?(this.x=0,this.y=0):"number"!=typeof e?(this.x=t,this.y=t):(this.x=t,this.y=e)}function D(t,e){for(var n,r,o=e.y+.5,i=0,a=0;a<t.length;a++)if(a==t.length-1?(n=t[a],r=t[0]):(n=t[a],r=t[a+1]),!((o-n.y)*(r.x-n.x)/(r.y-n.y)+n.x<e.x)){var c=o-n.y,u=o-r.y;0!=c&&0!=u||i++,Math.sign(c)!=Math.sign(u)&&i++}return i%2==1}function R(t){return function(t){if(Array.isArray(t))return L(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return L(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var W={},N=new I,G="",B=[],q=function(t){return N=new I(t.x,t.y),G=W.getColor(t),B=[],F(N,[],0),B.length>3?B=function(t){for(var e=[],n=4,r=4,o={min:{x:t[0].x,y:t[0].y},max:{x:t[0].x,y:t[0].y}},i=0;i<t.length-1;i++){var a=t[i+1],c=t[i];c.x<o.min.x&&(o.min.x=c.x),c.y<o.min.y&&(o.min.y=c.y),c.x>o.max.x&&(o.max.x=c.x),c.y>o.max.y&&(o.max.y=c.y),(r=a.x-c.x+3*(a.y-c.y)+4)!=n&&(n=r,e.push(c))}return e.push(t[t.length-1]),{path:e,bounding:o,source:t}}(B):{path:[]}};function F(t,e,n){var r;if(0!=e.length&&W.mark(t),0!=e.length&&t.x==N.x&&t.y==N.y)return B=R(e),W.unmark(t),!0;e.push(t);for(var o=0,i=0;i<8;i++)if(o=(n+2+i)%8,r=W.nextPos(o,t),!W.isMarked(r)&&W.getColor(r)==G&&!W.isInside(r)&&F(r,R(e),(o+4)%8))return W.unmark(t),!0;return W.unmark(t),!1}function U(t){for(var e=new I,n=W.getColor(t.path[0]),r=n==ce.local.color,o=0;o<t.source.length;o++)W.mark(t.source[o]);for(var i=t.bounding.min.x;i<=t.bounding.max.x;i++)for(var a=t.bounding.min.y;a<=t.bounding.max.y;a++){e.x=i,e.y=a;var c=W.getColor(e);W.isMarked(e)||D(t.path,e)&&(c==n||""==c||W.isInside(e)||(r?ce.local.score+=1:ce.remote.score+=1),W.markInside(e))}for(var u=0;u<t.source.length;u++)W.unmark(t.source[u])}var $=new function(){this.assignArr=function(t){W=t},this.findPath=q,this.markInsideNodes=U},H={},X=0;function Y(t,e,n){var r=this;H.setGroup(t,e),this.id=e,this.color=n,this.bounding={begin:new I(t.x,t.y),end:new I(t.x,t.y)},this.push=function(t){H.setGroup(t,r.id),t.x>r.bounding.end.x&&(r.bounding.end.x=t.x),t.y>r.bounding.end.y&&(r.bounding.end.y=t.y),t.x<r.bounding.begin.x&&(r.bounding.begin.x=t.x),t.y<r.bounding.begin.y&&(r.bounding.begin.y=t.y)},this.unify=function(t){for(var e=t.bounding,n=e.begin.x;n<=e.end.x;n++)for(var o=e.begin.y;o<=e.end.y;o++){var i={x:n,y:o};H.getGroup(i)==t.id&&r.push(i)}}}var J=new function(){var t=this;this.arr={},this.createGroup=function(e,n){t.arr[X]=new Y(e,X,n),X+=1},this.addToGroup=function(e,n){t.arr[n].push(e)},this.unify=function(e,n){if(e>n){var r=e;e=n,n=r}t.arr[e].unify(t.arr[n]),delete t.arr[n]},this.getBounding=function(e){return t.arr[e].bounding},this.getColor=function(e){return t.arr[e].color}};function K(t,e,n){for(var r=e.y;r<=n;r++){var o={x:e.x,y:r};if(!H.isInside(o)&&H.getGroup(o)==t)return o}return!1}function Q(t){for(var e=J.getBounding(t),n=J.getColor(t),r=e.begin.x+1;r<e.end.x;r++)for(var o=e.begin.y+1;o<e.end.y;o++){var i={x:r,y:o},a=H.getColor(i);if(""!=a&&a!=n&&!H.isInside(i)){var c=K(t,i,e.end.y);if(!c)continue;var u=$.findPath(c);if(u.path.length>0&&D(u.path,i))return $.markInsideNodes(u),u.path}}return[]}function V(t){var e=H.getColor(t),n=Q(function(t,e){for(var n=H.getGroup(t),r=0;r<8;r++){var o=H.nextPos(r,t);if(o){var i=H.getGroup(o);n=H.getGroup(t),H.isInside(o)||H.getColor(o)!=e||(-1==n?J.addToGroup(t,i):n!=i&&J.unify(n,i))}}return-1==n&&J.createGroup(t,e),H.getGroup(t)}(t,e));return n.length>0?n:function(t,e){var n=function(t,e){for(var n={x:t.x,y:t.y},r=t.y+1;r<H.size.y;r++){n.y=r;var o=H.getColor(n);if(o!=e&&""!=o&&!H.isInside(n))return n}return!1}(t,e);return n?Q(H.getGroup(n)):[]}(t,e)}var Z=new function(){this.assignArr=function(t){H=t},this.addDot=V};function tt(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return et(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?et(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function et(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function nt(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,ot(t,e,"get"))}function rt(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,ot(t,e,"set"),n),n}function ot(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var it=2*Math.PI;function at(){this.color="",this.connected=!1,this.inside=!1,this.marked=!1,this.group=-1}function ct(t,e){return!(!t||t.x<0||t.x>=e.x||t.y<0||t.y>=e.y)}function ut(t){for(var e=this,n=[],r=0;r<t.x;r++){n[r]=[];for(var o=0;o<t.y;o++)n[r][o]=new at}this.size=t,this.getColor=function(t){return ct(t,this.size)?n[t.x][t.y].color:""},this.setColor=function(t,e){ct(t,this.size)&&(n[t.x][t.y].color=e)},this.connect=function(t){ct(t,this.size)&&(n[t.x][t.y].connected=!0)},this.isConnected=function(t){return!!ct(t,this.size)&&n[t.x][t.y].connected},this.markInside=function(t){ct(t,this.size)&&(n[t.x][t.y].inside=!0)},this.isInside=function(t){return!!ct(t,this.size)&&n[t.x][t.y].inside},this.mark=function(t){ct(t,this.size)&&(n[t.x][t.y].marked=!0)},this.unmark=function(t){ct(t,this.size)&&(n[t.x][t.y].marked=!1)},this.isMarked=function(t){return!!ct(t,this.size)&&n[t.x][t.y].marked},this.setGroup=function(t,e){ct(t,this.size)&&(n[t.x][t.y].group=e)},this.getGroup=function(t){return ct(t,this.size),n[t.x][t.y].group},this.nextPos=function(t,n){var r=function(t,e){var n;switch(t){case 0:n=new I(e.x+1,e.y);break;case 1:n=new I(e.x+1,e.y-1);break;case 2:n=new I(e.x,e.y-1);break;case 3:n=new I(e.x-1,e.y-1);break;case 4:n=new I(e.x-1,e.y);break;case 5:n=new I(e.x-1,e.y+1);break;case 6:n=new I(e.x,e.y+1);break;case 7:n=new I(e.x+1,e.y+1)}return n}(t,n);if(!(r.x<0||r.x>=e.size.x||r.y<0||r.y>=e.size.y))return r}}var st={},lt=new WeakMap,ft=new WeakMap,pt=new WeakMap,ht=new WeakMap;function yt(t){if(!t)return"orange";var e=t.match(/[a-f\d]{2}/gi);return e?(e=e.map((function(t){return.5*parseInt(t,16)})).join(","),"rgb(".concat(e,")")):"orange"}var dt=new function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),lt.set(this,{writable:!0,value:0}),ft.set(this,{writable:!0,value:{}}),pt.set(this,{writable:!0,value:8}),ht.set(this,{writable:!0,value:[]}),this.init=function(t,e){rt(this,lt,e),rt(this,ft,t),st=new ut(t),$.assignArr(st),Z.assignArr(st)},this.push=function(t,e){if(""!=st.getColor(t)||st.isInside(t))return!1;st.setColor(t,e);var n=Z.addDot(t);return n.length>0&&nt(this,ht).push(n),!0},this.drawPaths=function(){for(var t=0;t<nt(this,ht).length;t++){var n=nt(this,ht)[t];e.beginPath(),e.strokeStyle=st.getColor(n[0]),e.lineWidth=3;var r,o=tt(n);try{for(o.s();!(r=o.n()).done;){var i=r.value;e.lineTo(i.x*nt(this,lt)+nt(this,lt)/2,i.y*nt(this,lt)+nt(this,lt)/2)}}catch(t){o.e(t)}finally{o.f()}e.closePath(),e.stroke()}},this.fillPaths=function(){for(var t=nt(this,ht).length-1;t>=0;t--){var n=nt(this,ht)[t];e.beginPath(),e.fillStyle=yt(st.getColor(n[0]));var r,o=tt(n);try{for(o.s();!(r=o.n()).done;){var i=r.value;e.lineTo(i.x*nt(this,lt)+nt(this,lt)/2,i.y*nt(this,lt)+nt(this,lt)/2)}}catch(t){o.e(t)}finally{o.f()}e.closePath(),e.fill()}},this.drawDots=function(){for(var t=0;t<nt(this,ft).x;t++)for(var n=0;n<nt(this,ft).y;n++){var r=st.getColor({x:t,y:n});""!=r&&(e.beginPath(),e.fillStyle=r,e.arc(t*nt(this,lt)+nt(this,lt)/2,n*nt(this,lt)+nt(this,lt)/2,nt(this,pt),0,it),e.fill())}}};function mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vt(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,bt(t,e,"get"))}function bt(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function gt(t,e,n){var r=t>n?n:t;return r<e?e:r}var wt=new WeakMap,xt=new(function(){function n(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),wt.set(this,{writable:!0,value:0}),this.size={x:15,y:15};var r,o,i,a=new Path2D;r=this,o=wt,i=t.width/this.size.x,function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(r,bt(r,o,"set"),i);for(var c=0;c<this.size.x;c++)a.moveTo(c*vt(this,wt)+vt(this,wt)/2,0),a.lineTo(c*vt(this,wt)+vt(this,wt)/2,t.height);for(var u=0;u<this.size.y;u++)a.moveTo(0,u*vt(this,wt)+vt(this,wt)/2),a.lineTo(t.width,u*vt(this,wt)+vt(this,wt)/2);dt.init(this.size,vt(this,wt)),this.drawField=function(){dt.fillPaths(),e.strokeStyle="black",e.lineWidth=2,e.stroke(a),dt.drawPaths(),dt.drawDots()}}var r,o;return r=n,(o=[{key:"placeDot",value:function(t,e){var n=this.getMeshCoord(t);return!!dt.push(n,e)&&(function(t){a.send("place ".concat(t.x," ").concat(t.y))}(n),!0)}},{key:"placeDotDirect",value:function(t,e){return dt.push(t,e)}},{key:"getMeshCoord",value:function(t){return{x:gt(Math.floor(t.x/vt(this,wt)),0,this.size.x-1),y:gt(Math.floor(t.y/vt(this,wt)),0,this.size.y-1)}}},{key:"getTargetCoord",value:function(t){var e={};return e.x=gt(Math.floor(t.x/vt(this,wt)),0,this.size.x-1),e.y=gt(Math.floor(t.y/vt(this,wt)),0,this.size.y-1),{x:e.x*vt(this,wt)+vt(this,wt)/2,y:e.y*vt(this,wt)+vt(this,wt)/2}}}])&&mt(r.prototype,o),n}());function kt(t){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pt(t,e){return(Pt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Et(t,e){return!e||"object"!==kt(e)&&"function"!=typeof e?Ot(t):e}function Ot(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function St(t){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ct(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Mt=function(n){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pt(t,e)}(u,n);var r,o,i,a,c=(i=u,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=St(i);if(a){var n=St(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Et(this,t)});function u(){var e;_t(this,u);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return Ct(Ot(e=c.call.apply(c,[this].concat(r))),"step",t.width/xt.size.x),Ct(Ot(e),"offset",0),Ct(Ot(e),"speed",4*t.height),e}return r=u,(o=[{key:"update",value:function(n){e.beginPath(),e.strokeStyle="black",e.lineWidth=2,this.offset+=n*this.speed,this.offset>=t.height&&this.onComplete();for(var r=0;r<xt.size.x;r++)e.moveTo(r*this.step+this.step/2,0),e.lineTo(r*this.step+this.step/2,this.offset);for(var o=0;o<xt.size.y;o++)e.moveTo(0,o*this.step+this.step/2),e.lineTo(this.offset,o*this.step+this.step/2);e.stroke()}}])&&Tt(r.prototype,o),u}(i),jt=0,At=100,zt=new function(){this.pos=new I,this.target=new I,this.radius=10,jt=this.radius,this.speed=10,this.draw=function(){e.beginPath(),e.fillStyle=ce.local.color,e.arc(zt.pos.x,zt.pos.y,jt,0,2*Math.PI),e.fill()},this.click=function(){At=0,jt=0},this.update=function(t){At<100?(jt=this.radius*(At/100),At+=500*t):jt=this.radius}},It=document.createElement("div");It.classList.add("now-turn");var Dt=document.createElement("p");Dt.classList.add("now-turn__text"),Dt.innerText="Сейчас ходит:",It.append(Dt);var Rt=document.createElement("div");Rt.classList.add("turn-container");var Lt=document.createElement("p");Lt.classList.add("turn-container__player");var Wt=document.createElement("p");Wt.classList.add("turn-container__player"),It.append(Rt);var Nt=document.createElement("div");Nt.classList.add("player-score-wrapper");var Gt=document.createElement("p");Gt.classList.add("player-score");var Bt=document.createElement("p");function qt(t){t?(Wt.classList.add("turn-container__player_hidden"),Rt.append(Lt),setTimeout((function(){Wt.remove(),Wt.classList.remove("turn-container__player_hidden")}),200)):(Lt.classList.add("turn-container__player_hidden"),Rt.append(Wt),setTimeout((function(){Lt.remove(),Lt.classList.remove("turn-container__player_hidden")}),200)),ce.local.score!=Ft.local&&(Ft.local=ce.local.score,Gt.innerText="".concat(ce.local.nickname,": ").concat(ce.local.score)),ce.remote.score!=Ft.remote&&(Ft.remote=ce.remote.score,Bt.innerText="".concat(ce.remote.nickname,": ").concat(ce.remote.score))}Bt.classList.add("player-score"),Nt.append(Gt,Bt);var Ft={local:0,remote:0};function Ut(t){return(Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xt(t,e){return(Xt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Yt(t,e){return!e||"object"!==Ut(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jt(t){return(Jt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Kt=new I,Qt=!1;(function(t){s=t})((function(t){xt.placeDotDirect(t,ce.remote.color),qt(Qt=!0)})),function(t){l=t}((function(t){Qt="local"==t}));var Vt=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xt(t,e)}(c,e);var n,r,o,i,a=(o=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Jt(o);if(i){var n=Jt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Yt(this,t)});function c(){return $t(this,c),a.apply(this,arguments)}return n=c,(r=[{key:"init",value:function(){var e,n,r;!function(t){document.querySelector(".header__logo").after(It),Lt.innerText=ce.local.nickname,Lt.style.color=ce.local.color,Wt.innerText=ce.remote.nickname,Wt.style.color=ce.remote.color,Rt.append(t?Lt:Wt),Gt.innerText="".concat(ce.local.nickname,": 0"),Bt.innerText="".concat(ce.remote.nickname,": 0"),Gt.style.borderColor=ce.local.color,Bt.style.borderColor=ce.remote.color,document.body.append(Nt)}(Qt),document.addEventListener("mousemove",(e=t.getBoundingClientRect(),n=t.width/e.width,r=t.height/e.height,function(t){Kt.x=(t.clientX-e.left)*n,Kt.y=(t.clientY-e.top)*r})),document.addEventListener("click",(function(){zt.click(),xt.placeDot(Kt,ce.local.color)&&qt(Qt=!Qt)})),xt.placeDotDirect({x:8,y:7},"orange"),xt.placeDotDirect({x:6,y:7},"orange")}},{key:"update",value:function(t){xt.drawField(),zt.target=xt.getTargetCoord(Kt),zt.pos.x+=(zt.target.x-zt.pos.x)*t*zt.speed,zt.pos.y+=(zt.target.y-zt.pos.y)*t*zt.speed,zt.update(t),zt.draw()}}])&&Ht(n.prototype,r),c}(i),Zt=Date.now();i.prototype.onComplete=function(){(re=re.getNext()).init(),e.restore()};var te=new A,ee=new Mt,ne=new Vt,re=te;function oe(){var n=Date.now(),r=(n-Zt)/1e3;Zt=n,e.clearRect(0,0,t.width,t.height),re.update(r),requestAnimationFrame(oe)}te.setNext(ee),ee.setNext(ne);var ie=["Щас_бы_на_дачу","SuperDominator","Placeholder","Плейсхолдер","Что-то_грустно","За_шо","Твое_имя","Petr","Паравозик_томас","Alukard","Милый_кисик","Доброжелатель","Абонент"];function ae(){return ie[Math.floor(Math.random()*ie.length)]}var ce={local:{score:0},remote:{color:"pink",nickname:ae(),score:0}},ue=function(){var t=document.createElement("form");t.className="welcome-popup__form";var e=document.createElement("div");e.className="welcome-popup__nickname-section";var n=document.createElement("label");n.className="welcome-popup__nickname-label",n.innerHTML='Твое имя:\n  <input\n    class="welcome-popup__nickname-field"\n    type="text"\n    name="nickname"\n    placeholder="'.concat(ae(),'"\n    autocomplete="off"\n    autofocus="autofocus"\n  />'),e.append(n);var r=document.createElement("ul");r.className="color-picker";for(var o=["#ee2b2b","#0bb870","#0db1f1","#e9a6da","#831583"],i=0;i<5;i++){var a=document.createElement("li"),c=document.createElement("input");a.className="color-picker__item",c.className="color-picker__button",c.setAttribute("type","radio"),c.setAttribute("name","color"),c.setAttribute("value",o[i]),0==i&&c.setAttribute("checked",""),a.append(c),c.style.backgroundColor=o[i],r.append(a)}var u=document.createElement("input");return u.className="welcome-popup__submit",u.setAttribute("type","submit"),u.setAttribute("name","submit"),u.setAttribute("value","Играть"),t.append(e),t.append(r),t.append(u),t.addEventListener("submit",le),t}(),se=function(t){var e=document.createElement("div");e.className="welcome-popup";var n=document.createElement("h3");return n.className="welcome-popup__title",n.innerText="Вход в игру",e.append(n),e.append(t),e}(ue);function le(t){se.classList.contains("welcome-popup_shown")&&(ce.local.color=ue.color.value,ce.local.nickname=ue.nickname.value,""==ce.local.nickname&&(ce.local.nickname=ue.nickname.placeholder),se.classList.remove("welcome-popup_shown"),a.send("join"),Zt=Date.now(),e.save(),requestAnimationFrame(oe),setTimeout((function(){return se.remove()}),150)),t.preventDefault()}window.onload=function(){document.body.append(se),requestAnimationFrame((function(){se.classList.toggle("welcome-popup_shown")}))}})();